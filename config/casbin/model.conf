# Casbin Access Control Model
# This model combines RBAC, ABAC, and MAC principles.

[request_definition]
# The structure of an access request: subject, object, action
# sub: The user's role (from JWT claims)
# obj: The resource path being accessed (e.g., /api/v1/asset/create)
# act: The HTTP method (e.g., POST, GET, PUT)
r = sub, obj, act

[policy_definition]
# The structure of a policy rule in the database.
# sub: The role (e.g., "Admin", "Employee", "AssetManager")
# obj: The resource path (can include wildcards like /asset/*)
# act: The HTTP method
# eft: The policy effect (allow or deny), defaults to allow if not specified.
p = sub, obj, act, eft

[role_definition]
# Defines role inheritance.
# g = user_id, role_name
# This means a user (identified by their ID) is assigned a role.
g = _, _

[policy_effect]
# If any matching policy has an 'allow' effect, and no matching policy has a 'deny' effect,
# then the request is allowed. This is a standard "allow-override" model.
e = some(where (p.eft == allow)) && !some(where (p.eft == deny))

[matchers]
# The logic to match an incoming request (r) against defined policies (p).
m = g(r.sub, p.sub) && keyMatch(r.obj, p.obj) && regexMatch(r.act, p.act)